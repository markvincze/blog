<!DOCTYPE html>
<html lang="en">

<head>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-72523215-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-72523215-1');
  </script>

  <title>Migrating a Ghost blog from SQLite to Postgre on OpenShift</title>

  <link rel="stylesheet" href="/styles/styles.css">
  <script defer src="https://use.fontawesome.com/releases/v5.15.1/js/all.js"></script>
  <script defer src="/scripts/scripts.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css" />

  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="manifest" href="site.webmanifest">

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="A guide about how to migrate a Ghost blog using SQLite to PostgreSQL running on Openshift." />
  <meta property="og:url" content="https://blog.markvincze.com/migrating-a-ghost-blog-from-sqlite-to-postgre-on-openshift/" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="Migrating a Ghost blog from SQLite to Postgre on OpenShift" />
  <meta property="og:description" content="A guide about how to migrate a Ghost blog using SQLite to PostgreSQL running on Openshift." />
  
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@mrkvincze" />
  <meta name="twitter:title" content="Migrating a Ghost blog from SQLite to Postgre on OpenShift" />
  <meta name="twitter:description" content="A guide about how to migrate a Ghost blog using SQLite to PostgreSQL running on Openshift." />
  

</head>

<body>
  <div class="navbar-container">
    <nav class="navbar container is-max-desktop" role="navigation" aria-label="main navigation">
      <div class="navbar-brand">

        <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navbarMenu">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
      </div>
      <div id="navbarMenu" class="navbar-menu has-text-white-ter">

        <div class="navbar-start">
          
          <a class="navbar-item" href="/">About</a>
          
          <a class="navbar-item" href="/posts">Blog</a>
          
          <a class="navbar-item" href="/projects">Projects</a>
          
        </div>

        <div class="navbar-end pt-2 ml-2">
          <a class="icon is-medium" href="https://twitter.com/mrkvincze" target="_blank">
            <i class="fab fa-lg fa-twitter"></i>
          </a>
          <a class="icon is-medium" href="https://www.github.com/markvincze" target="_blank">
            <i class="fab fa-lg fa-github"></i>
          </a>
          <a class="icon is-medium" href="https://stackoverflow.com/users/974733/mark-vincze" target="_blank">
            <i class="fab fa-lg fa-stack-overflow"></i>
          </a>
          <a class="icon is-medium" href="https://www.linkedin.com/in/markvincze" target="_blank">
            <i class="fab fa-lg fa-linkedin"></i>
          </a>
          <a class="icon is-medium" href="/index.xml" target="_blank">
            <i class="fas fa-lg fa-rss"></i>
          </a>
        </div>
      </div>
    </nav>
  </div>

  <div class="hero-body">
    <div class="container has-text-centered">
      <a href="/">
        <h1 class="title is-2">
          Mark Vincze
        </h1>
      </a>
      <h2 class="subtitle is-5">
        Software Developer
      </h2>
    </div>
  </div>

  

<section class="section">
  <div class="container is-max-desktop">
    <h1 class="title is-1">Migrating a Ghost blog from SQLite to Postgre on OpenShift</h1>

    
      


<p class="mb-3 is-vcentered">
  <time class="has-text-grey" datetime="2016-04-10">Apr 10, 2016 &bull;</time>

  
  
  <a class="button is-link is-light is-primary is-small p-2 mr-1 is-uppercase has-text-weight-semibold" style="height: 2em; margin-top: 0.1em" href="https://blog.markvincze.com/tags/ghost/">ghost</a>
  
  
  <a class="button is-link is-light is-primary is-small p-2 mr-1 is-uppercase has-text-weight-semibold" style="height: 2em; margin-top: 0.1em" href="https://blog.markvincze.com/tags/postgre/">postgre</a>
  
  
  <a class="button is-link is-light is-primary is-small p-2 mr-1 is-uppercase has-text-weight-semibold" style="height: 2em; margin-top: 0.1em" href="https://blog.markvincze.com/tags/sqlite/">sqlite</a>
  
  
  <a class="button is-link is-light is-primary is-small p-2 mr-1 is-uppercase has-text-weight-semibold" style="height: 2em; margin-top: 0.1em" href="https://blog.markvincze.com/tags/openshift/">openshift</a>
  

</p>
    

    <article class="content mt-6">
      <p>When I started this blog, I wanted to use the <a href="https://ghost.org/">Ghost</a> blogging platform. I was looking for a free solution for hosting it, and I didn&rsquo;t mind a little tinkering in order to get it running.<br>
At the time, the best approach I could find was hosting it on an Amazon EC2 instance, since Amazon offered a Free Tier, with which you could run a small Linux instance for free, for the duration of one year.</p>
<p>The one year duration of the Amazon Free Tier is coming to an end, so a couple of weeks ago I started to look for an alternative to host my blog. I found the <a href="https://www.openshift.com/">OpenShift</a> platform by Red Hat, where you can run a small machine instance for free, which seemed like the perfect alternative to run my blog.</p>
<p>The only problem was that on Amazon I was using the file-based SQLite approach to store my blog data, whereas on OpenShift the recommended method either MySql or Postgre. I decided to go with Postgre, so I needed to migrate all my blog data there from SQLite.</p>
<h2 id="getting-started">Getting started</h2>
<p>Creating a new Ghost blog on OpenShift is very simple, you can follow the guide on <a href="https://www.howtoinstallghost.com/how-to-install-ghost-on-openshift/">howtoinstallghost</a>.</p>
<p>After you created the new blog, you need to clone its git repository, copy all your static content, namely the <code>content/apps</code> and <code>content/themes</code> directories overwriting the existing content, and push it to the remote.</p>
<p>The other, much bigger task is to migrate the actual data from SQLite to the Postgre database.</p>
<h2 id="connecting-to-the-postgre-db-running-on-openshift">Connecting to the Postgre DB running on OpenShift</h2>
<p>Connecting to your new Postgre DB is simple, but it needs an extra step. Because of security reasons, you need a client side tool, which will open a secure tunnel between your computer and the DB server.</p>
<p>First you have to install <code>rhc</code> by following the <a href="https://developers.openshift.com/en/getting-started-windows.html#client-tools">official guide</a>.</p>
<p>After this, you have to initiate port-forwarding by executing the following command:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">rhc port-forward -a your-app-name
</code></pre></div><p>In the output of the command you&rsquo;ll find the port on localhost to which you have to connect to reach your Postgre DB.</p>
<p><img src="/images/2016/04/rhc-port-forward.png" alt="Use the rhc command to open a port to your Postgre DB."  style="display:block; margin: auto;" /></p>
<p>So I needed to connect to <code>localhost:62696</code>.<br>
For actually connecting to the DB, I was using the official <a href="http://www.pgadmin.org/">pgAdmin</a> client, but probably you can do the same thing with the command-line Postgre client too.</p>
<h2 id="clearing-the-db">Clearing the DB</h2>
<p>We want to migrate all our data and settings from the existing DB, however, the OpenShift Postgre DB contains some sample data by default. That data needs to be erased.<br>
With PostgreSQL, you can erase all data from a table using the <code>TRUNCATE TABLE</code> command. Furthermore, you can find a helpful little procedure in this <a href="https://stackoverflow.com/questions/2829158/truncating-all-tables-in-a-postgres-database">SO answer</a>, with which you can truncate all your tables in one step. (But if you just manually clear all your tables, that works too.)</p>
<h2 id="migrate-sqlite-data">Migrate Sqlite data</h2>
<p>With Sqlite3 it&rsquo;s easy to create a SQL script that creates an exact copy of our database and fills all the existing data into it. We can do this with the following command:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sqlite3 ghost.db .dump | grep -v <span style="color:#e6db74">&#34;^CREATE&#34;</span> | grep -v <span style="color:#e6db74">&#34;PRAGMA&#34;</span> | grep -v <span style="color:#e6db74">&#34;sqlite_sequence&#34;</span> &gt; blog.dump.sql
</code></pre></div><p>With piping a couple of greps together we remove all the lines we don&rsquo;t want to use with Postgre. (I&rsquo;ve found this command on <a href="https://andrade.io/ghost-blog-migrate-from-sqlite-to-postgres/">Leonardo Andrade&rsquo;s blog</a>.]</p>
<p>In order to be able to run this script on my Postgre DB, I needed to do a couple of tweaks on the script. Luckily the whole script is enclosed in one transaction, so you&rsquo;re free to try to run it again and again, it&rsquo;ll only insert anything into your DB after you successfully fixed all problems in the script.</p>
<p>If you end up in a situation where you accidentally inserted something into your DB anyway, simply purge all records again and start over.</p>
<h2 id="fix-errors-in-the-sqlite-dump-script">Fix errors in the Sqlite dump script</h2>
<p>There are a couple of incompatibilities between Sqlite and Postgre that we have to address if we want to successfully execute this script against our Postgre DB.<br>
I used a couple of very simple regexp replacements to fix all the different errors I encountered. You can use any text editor that supports regexp replacements, such as <a href="https://www.sublimetext.com/">Sublime Text</a>.</p>
<h3 id="fix-boolean-literals">Fix boolean literals</h3>
<p>Sqlite <a href="https://www.sqlite.org/datatype3.html">does not have a separate boolean data type</a>, rather the booleans are represented with integers having either <code>0</code> or <code>1</code> as their value. In the Postgre schema, the same columns are represented with booleans, and the literals <code>0</code> and <code>1</code> are not acceptable as boolean values, so our script will report an error everywhere booleans are used. The solution is to replace all <code>0</code> values with <code>FALSE</code>, and all <code>1</code>s with <code>TRUE</code>.<br>
This might be tricky to do for all different occurences, so I did it separately for all boolean columns. It&rsquo;s easy to do a replacement in a text editor based on the surrounding content of the literal. For example this was the first error I got, where the <code>0</code> value after <code>NULL</code> was invalid:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#f92672">&lt;</span>p<span style="color:#f92672">&gt;</span>That should be enough <span style="color:#66d9ef">to</span> <span style="color:#66d9ef">get</span> you started. Have fun <span style="color:#f92672">-</span> <span style="color:#66d9ef">and</span> let us know what you think :)<span style="color:#f92672">&lt;/</span>p<span style="color:#f92672">&gt;</span><span style="color:#e6db74">&#39;,NULL,0,0,&#39;</span>draft<span style="color:#e6db74">&#39;,&#39;</span>en_US<span style="color:#e6db74">&#39;,NULL,NULL,1,1429738370592,1,1430050851451,1,1429738370623,1);
</span><span style="color:#e6db74">                                                                                                    ^
</span></code></pre></div><p>So I could fix all occurrences of this column by replacing</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#e6db74">&#39;,NULL,0,(\d),&#39;</span>
</code></pre></div><p>with</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#e6db74">&#39;,NULL,FALSE,$1,&#39;</span>
</code></pre></div><p>Then I repeated the replacement from <code>',NULL,1,(\d),'</code> to <code>',NULL,TUE,$1,'</code>, so we take care of true values as well.</p>
<p>The second error was in the same insert statement, with the boolean value just after the one we fixed. This can be adjusted with a simple replacement, we have to replace</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#e6db74">&#39;,NULL,(FALSE|TRUE),0,&#39;</span>
</code></pre></div><p>with</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#e6db74">&#39;,NULL,$1,FALSE,&#39;</span>
</code></pre></div><p>Then I repeated this one too for true values, by replacing <code>',NULL,(FALSE|TRUE),1,'</code> with <code>',NULL,$1,TRUE,'</code>.</p>
<p>Another occurrence was in the <code>tags</code> table, I had to replace <code>',NULL,NULL,0,NULL,NULL,</code> with <code>',NULL,NULL,FALSE,NULL,NULL,</code>, and similarly for <code>TRUE</code>.</p>
<h3 id="fix-timestamps">Fix timestamps</h3>
<p>The next group of errors was caused by that in the Sqlite dump script timestamps are represented as bigints (Unix timestamps), which you need to convert to Postgre timestamps.<br>
Converting a Unix timestamp to a Postgre one is simple, you can use the following expression: <code>TO_CHAR(TO_TIMESTAMP(bigint_field / 1000), 'DD/MM/YYYY HH24:MI:SS')</code></p>
<p>All occurrences can be fixed with a general replacement from</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">,(<span style="color:#960050;background-color:#1e0010">\</span>d<span style="color:#960050;background-color:#1e0010">{</span><span style="color:#ae81ff">13</span><span style="color:#960050;background-color:#1e0010">}</span>),
</code></pre></div><p>to</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">,TO_TIMESTAMP(<span style="color:#960050;background-color:#1e0010">$</span><span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1000</span>),
</code></pre></div><p>On the other hand, running a general replacement like this is dangerous, because if you have the same content in any of your posts, that will be replaced as well. If you want to avoid that, you should use a couple of more granular replacements that consider the surrounding content of the script.</p>
<h3 id="difference-in-the-users-table">Difference in the users table</h3>
<p>This problem might have occurred to me only because I was using a different version of Ghost: in the <code>INSERT</code> statement for the <code>users</code> table the number of values was one less values than the number of columns, the column <code>tour_text</code> was missing.<br>
So at the end of those lines, I had to replace</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">NULL</span>,<span style="color:#66d9ef">NULL</span>,TO_TIMESTAMP(<span style="color:#ae81ff">1456936064255</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1000</span>),TO_TIMESTAMP(<span style="color:#ae81ff">1429738371778</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1000</span>),<span style="color:#ae81ff">1</span>,TO_TIMESTAMP(<span style="color:#ae81ff">1456936064255</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1000</span>),<span style="color:#ae81ff">1</span>);
</code></pre></div><p>with</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">NULL</span>,<span style="color:#66d9ef">NULL</span>,<span style="color:#66d9ef">NULL</span>,TO_TIMESTAMP(<span style="color:#ae81ff">1456936064255</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1000</span>),TO_TIMESTAMP(<span style="color:#ae81ff">1429738371778</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1000</span>),<span style="color:#ae81ff">1</span>,TO_TIMESTAMP(<span style="color:#ae81ff">1456936064255</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1000</span>),<span style="color:#ae81ff">1</span>);
</code></pre></div><h3 id="missing-columns-in-the-clients-table">Missing columns in the clients table</h3>
<p>A couple of columns were missing from <code>clients</code>, I looked up their default value in a newly created DB, and based on that I had to replace</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> <span style="color:#e6db74">&#34;clients&#34;</span> <span style="color:#66d9ef">VALUES</span>(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;6d74790e-d879-484f-85bb-d1b608e46f52&#39;</span>,<span style="color:#e6db74">&#39;Ghost Admin&#39;</span>,<span style="color:#e6db74">&#39;ghost-admin&#39;</span>,<span style="color:#e6db74">&#39;not_available&#39;</span>,TO_TIMESTAMP(<span style="color:#ae81ff">1429738370626</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1000</span>),<span style="color:#ae81ff">1</span>,TO_TIMESTAMP(<span style="color:#ae81ff">1429738370626</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1000</span>),<span style="color:#ae81ff">1</span>);
</code></pre></div><p>with</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> <span style="color:#e6db74">&#34;clients&#34;</span> <span style="color:#66d9ef">VALUES</span>(<span style="color:#ae81ff">1</span>,<span style="color:#e6db74">&#39;6d74790e-d879-484f-85bb-d1b608e46f52&#39;</span>,<span style="color:#e6db74">&#39;Ghost Admin&#39;</span>,<span style="color:#e6db74">&#39;ghost-admin&#39;</span>,<span style="color:#e6db74">&#39;&#39;</span>,<span style="color:#e6db74">&#39;not_available&#39;</span>,<span style="color:#e6db74">&#39;&#39;</span>,<span style="color:#e6db74">&#39;enabled&#39;</span>,<span style="color:#e6db74">&#39;ua&#39;</span>,<span style="color:#e6db74">&#39;description&#39;</span>,TO_TIMESTAMP(<span style="color:#ae81ff">1429738370626</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1000</span>),<span style="color:#ae81ff">1</span>,TO_TIMESTAMP(<span style="color:#ae81ff">1429738370626</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1000</span>),<span style="color:#ae81ff">1</span>);
</code></pre></div><p>After all these tweaks, I was able to successfully run the script to load all the data into the DB.</p>
<h2 id="fix-sequences">Fix sequences</h2>
<p>The last problem was that by purging all the data from the tables and inserting with explicit primary key values we messed up the current values of all our sequences, and insert statements would fail. This can be easily fixed by run the following commands.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> setval(<span style="color:#e6db74">&#39;accesstokens_id_seq&#39;</span>, (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">MAX</span>(id) <span style="color:#66d9ef">FROM</span> accesstokens)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">SELECT</span> setval(<span style="color:#e6db74">&#39;app_fields_id_seq&#39;</span>, (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">MAX</span>(id) <span style="color:#66d9ef">FROM</span> app_fields)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">SELECT</span> setval(<span style="color:#e6db74">&#39;app_settings_id_seq&#39;</span>, (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">MAX</span>(id) <span style="color:#66d9ef">FROM</span> app_settings)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">SELECT</span> setval(<span style="color:#e6db74">&#39;apps_id_seq&#39;</span>, (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">MAX</span>(id) <span style="color:#66d9ef">FROM</span> apps)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">SELECT</span> setval(<span style="color:#e6db74">&#39;client_trusted_domains_id_seq&#39;</span>, (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">MAX</span>(id) <span style="color:#66d9ef">FROM</span> client_trusted_domains)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">SELECT</span> setval(<span style="color:#e6db74">&#39;clients_id_seq&#39;</span>, (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">MAX</span>(id) <span style="color:#66d9ef">FROM</span> clients)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">SELECT</span> setval(<span style="color:#e6db74">&#39;permissions_apps_id_seq&#39;</span>, (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">MAX</span>(id) <span style="color:#66d9ef">FROM</span> permissions_apps)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">SELECT</span> setval(<span style="color:#e6db74">&#39;permissions_id_seq&#39;</span>, (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">MAX</span>(id) <span style="color:#66d9ef">FROM</span> permissions)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">SELECT</span> setval(<span style="color:#e6db74">&#39;permissions_roles_id_seq&#39;</span>, (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">MAX</span>(id) <span style="color:#66d9ef">FROM</span> permissions_roles)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">SELECT</span> setval(<span style="color:#e6db74">&#39;permissions_users_id_seq&#39;</span>, (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">MAX</span>(id) <span style="color:#66d9ef">FROM</span> permissions_users)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">SELECT</span> setval(<span style="color:#e6db74">&#39;posts_id_seq&#39;</span>, (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">MAX</span>(id) <span style="color:#66d9ef">FROM</span> posts)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">SELECT</span> setval(<span style="color:#e6db74">&#39;posts_tags_id_seq&#39;</span>, (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">MAX</span>(id) <span style="color:#66d9ef">FROM</span> posts_tags)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">SELECT</span> setval(<span style="color:#e6db74">&#39;refreshtokens_id_seq&#39;</span>, (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">MAX</span>(id) <span style="color:#66d9ef">FROM</span> refreshtokens)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">SELECT</span> setval(<span style="color:#e6db74">&#39;roles_id_seq&#39;</span>, (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">MAX</span>(id) <span style="color:#66d9ef">FROM</span> roles)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">SELECT</span> setval(<span style="color:#e6db74">&#39;roles_users_id_seq&#39;</span>, (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">MAX</span>(id) <span style="color:#66d9ef">FROM</span> roles_users)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">SELECT</span> setval(<span style="color:#e6db74">&#39;settings_id_seq&#39;</span>, (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">MAX</span>(id) <span style="color:#66d9ef">FROM</span> settings)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">SELECT</span> setval(<span style="color:#e6db74">&#39;tags_id_seq&#39;</span>, (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">MAX</span>(id) <span style="color:#66d9ef">FROM</span> tags)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
<span style="color:#66d9ef">SELECT</span> setval(<span style="color:#e6db74">&#39;users_id_seq&#39;</span>, (<span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">MAX</span>(id) <span style="color:#66d9ef">FROM</span> users)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
</code></pre></div><p>After this last fix, your new Ghost blog on PostgreSQL should be up and running!</p>

    </article>

    
    <div id="disqus_thread"></div>
    <script>
      var disqus_config = function () {
        this.page.url = 'https:\/\/blog.markvincze.com\/migrating-a-ghost-blog-from-sqlite-to-postgre-on-openshift\/';
        
        this.page.identifier = 'ghost-18';
        
      };
      (function () { 
        var d = document, s = d.createElement('script');
        s.src = 'https://markvinczeblog.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
  

</section>



  <div style="flex: 1"></div>

  <footer class="footer py-6">
    <div class="content has-text-centered">
      <p>
        Â© 2020 <strong>Mark Vincze</strong>. All rights reserved.<br />
        Built with <a href="https://gohugo.io/">Hugo</a> and <a href="https://bulma.io/">Bulma</a>. ðŸ’™
      </p>
    </div>
  </footer>

</body>

</html>